import{j as e,e as f,f as b,g as w}from"./index.Cz5khGiF.js";import{r as i}from"./index.C0PbZYII.js";import{s as m}from"./supabase.Bouij7RW.js";import"./_commonjsHelpers.gnU0ypJ3.js";import"./preload-helper.BlTxHScW.js";function E(){const[g,d]=i.useState(!1),[a,l]=i.useState(!1),[u,n]=i.useState(null),[o,c]=i.useState({email:"",password:""});i.useEffect(()=>{const r=()=>{d(!0),n(null)};return document.addEventListener("open-login-modal",r),()=>{document.removeEventListener("open-login-modal",r)}},[]),i.useEffect(()=>{},[]);const x=async r=>{r.preventDefault(),n(""),l(!0);try{console.log("Intentando iniciar sesión con:",o.email);const{data:s,error:p}=await m.auth.signInWithPassword({email:o.email,password:o.password});if(p)throw p;console.log("Inicio de sesión exitoso:",s)}catch(s){console.error("Error al iniciar sesión:",s),n(s.message),l(!1)}},h=async()=>{l(!0),n("");try{console.log("Iniciando login con Discord...");const{data:r,error:s}=await m.auth.signInWithOAuth({provider:"discord",options:{redirectTo:`${window.location.origin}/auth/callback`,scopes:"identify email guilds"}});if(s)throw s;if(console.log("Discord OAuth data:",r),r?.url)console.log("Redirigiendo a Discord OAuth:",r.url),window.location.href=r.url;else throw new Error("No se recibió URL de redirección de Discord")}catch(r){console.error("Error en login con Discord:",r),n(r.message),l(!1)}},t=async()=>{l(!0),n("");try{console.log("Iniciando login con Google...");const{data:r,error:s}=await m.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`}});if(s)throw s;if(r?.url)console.log("Redirigiendo a Google OAuth:",r.url),window.location.href=r.url;else throw new Error("No se recibió URL de redirección de Google")}catch(r){console.error("Error en login con Google:",r),n(r.message),l(!1)}};return g?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:e.jsxs("div",{className:"relative w-full max-w-md bg-wineblack border border-neutral-gray/50 rounded-xl shadow-xl p-6",children:[e.jsx("button",{onClick:()=>d(!1),className:"absolute top-4 right-4 text-neutral-gray hover:text-white transition-colors",disabled:a,children:e.jsx(f,{size:20})}),e.jsx("h2",{className:"text-2xl font-bold mb-6 text-white text-center",children:"Bienvenido de nuevo"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("button",{onClick:h,disabled:a,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#5865F2] text-white rounded-md hover:bg-opacity-90 transition-all disabled:opacity-50",children:[e.jsx(b,{size:20}),e.jsx("span",{children:a?"Conectando...":"Continuar con Discord"})]}),e.jsxs("button",{onClick:t,disabled:a,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-white text-gray-800 rounded-md hover:bg-opacity-90 transition-all disabled:opacity-50",children:[e.jsx(w,{size:20}),e.jsx("span",{children:a?"Conectando...":"Continuar con Google"})]})]}),e.jsxs("div",{className:"relative flex items-center my-6",children:[e.jsx("div",{className:"flex-grow border-t border-neutral-gray/30"}),e.jsx("span",{className:"flex-shrink mx-4 text-neutral-gray",children:"o"}),e.jsx("div",{className:"flex-grow border-t border-neutral-gray/30"})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-neutral-gray mb-1",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:o.email,onChange:r=>c(s=>({...s,email:r.target.value})),className:"w-full px-4 py-3 bg-neutral-gray/20 border border-neutral-gray/30 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-redvelvet",placeholder:"tu@email.com",required:!0,disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-neutral-gray mb-1",children:"Contraseña"}),e.jsx("input",{type:"password",id:"password",value:o.password,onChange:r=>c(s=>({...s,password:r.target.value})),className:"w-full px-4 py-3 bg-neutral-gray/20 border border-neutral-gray/30 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-redvelvet",placeholder:"••••••••",required:!0,disabled:a})]}),u&&e.jsx("div",{className:"text-red-500 text-sm bg-red-500/10 p-3 rounded-md",children:u}),e.jsx("button",{type:"submit",disabled:a,className:"w-full py-3 px-4 bg-redvelvet text-white rounded-md hover:bg-opacity-90 transition-all disabled:opacity-50",children:a?"Iniciando sesión...":"Iniciar Sesión"})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:()=>{d(!1),document.dispatchEvent(new CustomEvent("open-register-modal"))},className:"text-neutral-gray hover:text-white transition-colors",disabled:a,children:"¿No tienes una cuenta? Regístrate"})})]})}):null}function k(){const[g,d]=i.useState(!1),[a,l]=i.useState(!1),[u,n]=i.useState(null),[o,c]=i.useState({email:"",password:"",confirmPassword:""});i.useEffect(()=>{const t=()=>d(!0);return document.addEventListener("open-register-modal",t),()=>{document.removeEventListener("open-register-modal",t)}},[]);const x=async t=>{t.preventDefault(),n(""),l(!0);try{if(o.password!==o.confirmPassword)throw new Error("Las contraseñas no coinciden");const{data:r,error:s}=await m.auth.signUp({email:o.email,password:o.password,options:{data:{full_name:"",username:"",bio:"",website:"",twitter:"",instagram:"",youtube:"",tiktok:"",discord_connected:!1,discord_id:null,discord_username:null,discord_avatar:null,avatar_url:null}}});if(s)throw s;d(!1),c({email:"",password:"",confirmPassword:""}),alert("¡Registro exitoso! Por favor, verifica tu email para activar tu cuenta.")}catch(r){console.error("Error al registrarse:",r),n(r.message)}finally{l(!1)}},h=async()=>{try{const{data:t,error:r}=await m.auth.signInWithOAuth({provider:"discord",options:{redirectTo:`${window.location.origin}/auth/callback`,scopes:"identify email guilds"}});if(r)throw r;t?.url&&(window.location.href=t.url)}catch(t){console.error("Error en registro con Discord:",t),n(t.message)}};return g?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:e.jsxs("div",{className:"relative w-full max-w-md bg-wineblack border border-neutral-gray/50 rounded-xl shadow-xl p-6 animate-[fadeIn_0.3s_ease-in-out]",children:[e.jsx("button",{onClick:()=>d(!1),className:"absolute top-4 right-4 text-neutral-gray hover:text-white transition-colors",children:e.jsx(f,{size:20})}),e.jsx("h2",{className:"text-2xl font-bold mb-6 text-white text-center",children:"Crear cuenta"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsxs("button",{onClick:h,className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-[#5865F2] text-white rounded-md hover:bg-opacity-90 transition-all",children:[e.jsx(b,{size:20}),e.jsx("span",{children:"Continuar con Discord"})]}),e.jsxs("button",{className:"w-full flex items-center justify-center gap-2 py-3 px-4 bg-white text-gray-800 rounded-md hover:bg-opacity-90 transition-all",children:[e.jsx(w,{size:20}),e.jsx("span",{children:"Continuar con Google"})]})]}),e.jsxs("div",{className:"relative flex items-center my-6",children:[e.jsx("div",{className:"flex-grow border-t border-neutral-gray/30"}),e.jsx("span",{className:"flex-shrink mx-4 text-neutral-gray",children:"o"}),e.jsx("div",{className:"flex-grow border-t border-neutral-gray/30"})]}),e.jsxs("form",{onSubmit:x,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"register-email",className:"block text-sm font-medium text-neutral-gray mb-1",children:"Email"}),e.jsx("input",{type:"email",id:"register-email",value:o.email,onChange:t=>c(r=>({...r,email:t.target.value})),className:"w-full px-4 py-3 bg-neutral-gray/20 border border-neutral-gray/30 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-redvelvet",placeholder:"tu@email.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"register-password",className:"block text-sm font-medium text-neutral-gray mb-1",children:"Contraseña"}),e.jsx("input",{type:"password",id:"register-password",value:o.password,onChange:t=>c(r=>({...r,password:t.target.value})),className:"w-full px-4 py-3 bg-neutral-gray/20 border border-neutral-gray/30 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-redvelvet",placeholder:"••••••••",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"register-confirm-password",className:"block text-sm font-medium text-neutral-gray mb-1",children:"Confirmar Contraseña"}),e.jsx("input",{type:"password",id:"register-confirm-password",value:o.confirmPassword,onChange:t=>c(r=>({...r,confirmPassword:t.target.value})),className:"w-full px-4 py-3 bg-neutral-gray/20 border border-neutral-gray/30 rounded-md text-white focus:outline-none focus:ring-2 focus:ring-redvelvet",placeholder:"••••••••",required:!0})]}),u&&e.jsx("div",{className:"text-red-500 text-sm",children:u}),e.jsx("button",{type:"submit",disabled:a,className:"w-full py-3 px-4 bg-redvelvet text-white rounded-md hover:bg-opacity-90 transition-all disabled:opacity-50",children:a?"Registrando...":"Registrarse"})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("button",{onClick:()=>{d(!1),document.dispatchEvent(new CustomEvent("open-login-modal"))},className:"text-neutral-gray hover:text-white transition-colors",children:"¿Ya tienes una cuenta? Inicia sesión"})})]})}):null}export{E as LoginModal,k as RegisterModal};
